/**
 * Author: https://github.com/Barrior
 * DDSort: drag and drop sorting.
 */
+function(b){var a={down:b.noop,move:b.noop,up:b.noop,target:"li",delay:100,cloneStyle:{"background-color":"#eee"},floatStyle:{position:"fixed","box-shadow":"10px 10px 20px 0 #eee",webkitTransform:"rotate(4deg)",mozTransform:"rotate(4deg)",msTransform:"rotate(4deg)",transform:"rotate(4deg)"}};b.fn.DDSort=function(c){var e=b(document);var d=b.extend(true,{},a,c);return this.each(function(){var g=b(this);var h="height";var f="width";if(g.css("box-sizing")=="border-box"){h="outerHeight";f="outerWidth"}g.on("mousedown.DDSort",d.target,function(n){var l=new Date().getTime();if(n.which!=1){return}var k=n.target.tagName.toLowerCase();if(k=="input"||k=="textarea"||k=="select"||b(n.target).prop("contenteditable")=="true"){return}var v=this;var q=b(v);var i=q.offset();var t=n.pageX-i.left;var s=n.pageY-i.top;var p=q.clone().css(d.cloneStyle).css("height",q[h]()).empty();var r=1;var m=q.outerHeight();var j=g.outerHeight();var u=m;var o=m;var w=m*3;d.down.call(v);e.on("mousemove.DDSort",function(D){if(new Date().getTime()-l<d.delay){return}if(r){q.before(p).css("width",q[f]()).css(d.floatStyle).appendTo(q.parent());r=0}var C=D.pageX-t;var B=D.pageY-s;var A=p.prev();var z=p.next().not(q);q.css({left:C-e.scrollLeft(),top:B-e.scrollTop()});if(A.length&&B<A.offset().top+A.outerHeight()/2){p.after(A)}else{if(z.length&&B+m>z.offset().top+z.outerHeight()/2){p.before(z)}}var y=g.scrollTop();var x=g.offset().top;var E;if(B<x){o=m;u=++u>w?w:u;E=y-u}else{if(B+m-x>j){u=m;o=++o>w?w:o;E=y+o}}g.scrollTop(E);d.move.call(v,C-e.scrollLeft(),B-e.scrollTop())}).on("mouseup.DDSort",function(){e.off("mousemove.DDSort mouseup.DDSort");if(!r){p.before(q.removeAttr("style")).remove();d.up.call(v)}});return false})})}}(jQuery);