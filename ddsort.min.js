/**
 * DDSort: drag and drop sorting.
 * Documentation: https://github.com/Barrior/DDSort
 */
+function(e){var b={down:e.noop,move:e.noop,up:e.noop,target:"li",delay:100,cloneStyle:{"background-color":"#eee"},floatStyle:{position:"fixed","box-shadow":"10px 10px 20px 0 #eee",webkitTransform:"rotate(4deg)",mozTransform:"rotate(4deg)",msTransform:"rotate(4deg)",transform:"rotate(4deg)"}};e.fn.DDSort=function(h){var j=e(document);var i=e.extend(true,{},b,h);return this.each(function(){var o=e(this);var k="height";var m="width";var n=this.scrollWidth>this.clientWidth;var l=this.scrollHeight>this.clientHeight;if(o.css("box-sizing")=="border-box"){k="outerHeight";m="outerWidth"}o.on("mousedown.DDSort touchstart.DDSort",i.target,function(F){var B=new Date().getTime();if(F.type=="mousedown"&&F.which!=1){return}var u=F.target.tagName.toLowerCase();if(u=="input"||u=="textarea"||u=="select"||u=="a"||e(F.target).prop("contenteditable")=="true"){return}var C=this;var x=e(C);var w=x.offset();var r=F.pageX;var q=F.pageY;var H=F.originalEvent.targetTouches;if(F.type=="touchstart"&&H){r=H[0].pageX;q=H[0].pageY}var G=x.clone().css(i.cloneStyle).css("height",x[k]()).empty();var z=1;var A=x.outerHeight(),D=x.outerWidth(),E=o.outerHeight(),p=o.outerWidth();var v=A,y=A,s=D,t=D,I=A*3;i.down.call(C);j.on("mousemove.DDSort touchmove.DDSort",function(Q){var P=Q.pageX;var O=Q.pageY;var S=Q.originalEvent.targetTouches;if(Q.type=="touchmove"&&S){P=S[0].pageX;O=S[0].pageY}if(new Date().getTime()-B<i.delay){return}if(z){x.before(G).css("width",x[m]()).css(i.floatStyle).appendTo(x.parent());z=0}var Z=r-P;var Y=q-O;var L=w.left-Z;var U=w.top-Y;x.offset({left:L,top:U});var J=a(G),V=g(G,x),N=d(G),T=f(G,x);if(N&&N.length&&U<N.offset().top+N.outerHeight(true)/2){N.before(G)}else{if(T&&T.length&&U+A>T.offset().top+T.outerHeight(true)/2){T.after(G)}else{if(J&&J.length&&L<J.offset().left+J.outerWidth(true)/2){J.before(G)}else{if(V&&V.length&&L+D>V.offset().left+V.outerWidth(true)/2){V.after(G)}}}}if(l){var X=o.scrollTop();var W=o.offset().top;if(U<W){y=A;v=++v>I?I:v;var R=X-v;o.scrollTop(R)}else{if(U+A-W>E){v=A;y=++y>I?I:y;var R=X+y;o.scrollTop(R)}}}if(n){var M=o.scrollLeft();var K=o.offset().left;if(L<o.offset().left){t=D;s=++s>I?I:s;var R=M-s;o.scrollLeft(R)}else{if(L+D-K>p){s=D;t=++t>I?I:t;var R=M+t;o.scrollLeft(R)}}}i.move.call(C,L,U)}).on("mouseup.DDSort touchend.DDSort",function(){j.off("mousemove.DDSort mouseup.DDSort touchmove.DDSort touchend.DDSort");if(!z){G.before(x.removeAttr("style")).remove();i.up.call(C)}});return false})})};var c=5;var a=function(j){var i=j.prev();if(i.length&&j.offset().top==i.offset().top){var h=Math.abs(j.offset().left-(i.offset().left+i.outerWidth(true)));if(h<=c){return i}}return undefined};var d=function(j,i){if(!i){i=j.prev()}if(!i.length){return undefined}if(j.offset().left==i.offset().left){var h=Math.abs(j.offset().top-(i.offset().top+i.outerHeight(true)));if(h<=c){return i}}return d(j,i.prev())};var g=function(k,j){var i=k.next().not(j);if(i.length&&k.offset().top==i.offset().top){var h=Math.abs(k.offset().left-(i.offset().left-k.outerWidth(true)));if(h<=c){return i}}return undefined};var f=function(k,j,i){if(!i){i=k.next().not(j)}if(!i.length){return undefined}if(k.offset().left==i.offset().left){var h=Math.abs(k.offset().top-(i.offset().top-k.outerHeight(true)));if(h<=c){return i}}return f(k,j,i.next().not(j))}}(jQuery);