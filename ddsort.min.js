/**
 * DDSort: drag and drop sorting.
 * Documentation: https://github.com/Barrior/DDSort
 */
+function(e){var b={down:e.noop,move:e.noop,up:e.noop,target:"li",delay:100,cloneStyle:{"background-color":"#eee"},floatStyle:{position:"fixed","box-shadow":"10px 10px 20px 0 #eee",webkitTransform:"rotate(4deg)",mozTransform:"rotate(4deg)",msTransform:"rotate(4deg)",transform:"rotate(4deg)"}};e.fn.DDSort=function(h){var j=e(document);var i=e.extend(true,{},b,h);return this.each(function(){var m=e(this);var k="height";var l="width";if(m.css("box-sizing")=="border-box"){k="outerHeight";l="outerWidth"}m.on("mousedown.DDSort touchstart.DDSort",i.target,function(D){var z=new Date().getTime();if(D.type=="mousedown"&&D.which!=1){return}var q=D.target.tagName.toLowerCase();if(q=="input"||q=="textarea"||q=="select"||q=="a"||e(D.target).prop("contenteditable")=="true"){return}var A=this;var v=e(A);var u=v.offset();var p=D.pageX;var o=D.pageY;var F=D.originalEvent.targetTouches;if(D.type=="touchstart"&&F){p=F[0].pageX;o=F[0].pageY}var t=p-u.left;var s=o-u.top;var E=v.clone().css(i.cloneStyle).css("height",v[k]()).empty();var x=1;var y=v.outerHeight(),B=v.outerWidth(),C=m.outerHeight(),n=m.outerWidth();var r=y;var w=y;var G=y*3;i.down.call(A);j.on("mousemove.DDSort touchmove.DDSort",function(M){var L=M.pageX;var K=M.pageY;var O=M.originalEvent.targetTouches;if(M.type=="touchmove"&&O){L=O[0].pageX;K=O[0].pageY}if(new Date().getTime()-z<i.delay){return}if(x){v.before(E).css("width",v[l]()).css(i.floatStyle).appendTo(v.parent());x=0}var I=L-t;var Q=K-s;var H=a(E),R=g(E,v),J=d(E),P=f(E,v);v.css({left:I-j.scrollLeft(),top:Q-j.scrollTop()});if(J&&J.length&&Q<J.offset().top+J.outerHeight(true)/2){J.before(E)}else{if(P&&P.length&&Q+y>P.offset().top+P.outerHeight(true)/2){P.after(E)}else{if(H&&H.length&&I<H.offset().left+H.outerWidth(true)/2){H.before(E)}else{if(R&&R.length&&I+B>R.offset().left+R.outerWidth(true)/2){R.after(E)}}}}var T=m.scrollTop();var S=m.offset().top;var N;if(Q<S){w=y;r=++r>G?G:r;N=T-r}else{if(Q+y-S>C){r=y;w=++w>G?G:w;N=T+w}}m.scrollTop(N);i.move.call(A,I-j.scrollLeft(),Q-j.scrollTop())}).on("mouseup.DDSort touchend.DDSort",function(){j.off("mousemove.DDSort mouseup.DDSort touchmove.DDSort touchend.DDSort");if(!x){E.before(v.removeAttr("style")).remove();i.up.call(A)}});return false})})};var c=5;var a=function(j){var i=j.prev();if(i.length&&j.offset().top==i.offset().top){var h=Math.abs(j.offset().left-(i.offset().left+i.outerWidth(true)));if(h<=c){return i}}return undefined};var d=function(j,i){if(!i){i=j.prev()}if(!i.length){return undefined}if(j.offset().left==i.offset().left){var h=Math.abs(j.offset().top-(i.offset().top+i.outerHeight(true)));if(h<=c){return i}}return d(j,i.prev())};var g=function(k,j){var i=k.next().not(j);if(i.length&&k.offset().top==i.offset().top){var h=Math.abs(k.offset().left-(i.offset().left-i.outerWidth(true)));if(h<=c){return i}}return undefined};var f=function(k,j,i){if(!i){i=k.next().not(j)}if(!i.length){return undefined}if(k.offset().left==i.offset().left){var h=Math.abs(k.offset().top-(i.offset().top-i.outerHeight(true)));if(h<=c){return i}}return f(k,j,i.next().not(j))}}(jQuery);